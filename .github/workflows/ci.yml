name: Run UI Tests in Docker with FFMPEG

on:
  workflow_dispatch:
  push:
    branches:
      - main

jobs:
  ui-tests:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Docker container with FFMPEG and Maven
        run: |
          docker build -t ui-tests-image -f Dockerfile .

      - name: Run tests inside Docker
        run: |
          docker run --rm \
            -v ${{ github.workspace }}:/app \
            ui-tests-image \
            mvn test \
              -Dvideo.folder=target/videos \
              -Dvideo.enabled=true \
              -Dvideo.mode=ALL \
              -Drecorder.type=FFMPEG \
              -Dvideo.save.mode=ALL \
              -Dsurefire.suiteXmlFiles=/app/src/test/resources/testng.xml
